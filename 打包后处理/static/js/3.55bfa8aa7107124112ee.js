webpackJsonp([3],{"8hXn":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),r=a.n(s),i=a("exGp"),n=a.n(i),c=a("P9l9"),o=a("mCTZ"),l={data:function(){return{stateImgUrl:"./static/img/identityCard.gif",exchageImgUrl:"./static/img/plugInCard.gif",waitLayer:!1,exChangeLayer:!1,exChangeSuccessLayer:!1,exChangeErrLayer:!1,isMask:!1,operate:"",exChangeResult:{}}},computed:{errState:function(){return this.$store.getters.errorState},swipeComplete:function(){return this.$store.getters.swipeComplete},swallowComplete:function(){return this.$store.getters.swallowComplete}},watch:{errState:function(e){console.log(e,"errState---96"),e&&(this.errCancel(),this.$store.dispatch("SetErrorState",!1))},swipeComplete:function(e){if(console.log(e,"isComplete"),e){switch(this.operate){case"Recharge":this.againExchange();break;case"ToMall":this.mallshop()}this.$store.dispatch("SetSwipeComplete",!1)}},swallowComplete:function(e){e&&this.checkCard(window.localStorage.getItem("card_No"))}},mounted:function(){Object(o.a)()},methods:{errCancel:function(){this.waitLayer=!1,this.exChangeSuccessLayer=!1,this.exChangeErrLayer=!1,this.exChangeLayer=!1,this.isMask=!1,this.$store.dispatch("SetSwipeState",0),this.$store.dispatch("SetSwallowState",0)},checkCard:function(e){var t=this;return n()(r.a.mark(function a(){var s,i;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(s={}).cardNumber=e,s.classCode=window.localStorage.getItem("classId"),s.className=window.localStorage.getItem("className"),s.gradeCode=window.localStorage.getItem("gradeId"),s.schoolCode=window.localStorage.getItem("xxdm"),s.userId=window.localStorage.getItem("card_oauserid"),s.userName=window.localStorage.getItem("card_username"),a.next=10,c.a(s);case 10:if(1!=(i=a.sent).resultCode){a.next=19;break}return t.exChangeResult=i.value,a.next=15,c.q();case 15:a.sent,t.successExchange(),a.next=23;break;case 19:return a.next=21,c.v();case 21:a.sent,t.errorExchange();case 23:return a.next=25,c.r();case 25:a.sent,t.$store.dispatch("SetSwallowComplete",!1),console.log(i,"兑换成功");case 28:case"end":return a.stop()}},a,t)}))()},exchange:function(){console.log(window.localStorage.getItem("token"),"token"),window.localStorage.getItem("token")?this.againExchange():(this.$store.dispatch("SetSwipeState",1),this.isMask=!0,this.waitLayer=!0,this.operate="Recharge")},againExchange:function(){var e=this;return n()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(window.localStorage.getItem("token")){t.next=4;break}return e.cancelLayer(),e.$LayerTips({content:"用户已过期",time:2e3}),t.abrupt("return",!1);case 4:e.$router.push({path:"/exchange"});case 5:case"end":return t.stop()}},t,e)}))()},mallshop:function(){var e=this;return n()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:window.localStorage.getItem("token")?e.$router.push({path:"/mall"}):(e.$store.dispatch("SetSwipeState",1),console.log(e.$store.getters.swipeState,"当前状态"),e,e.isMask=!0,e.waitLayer=!0,e.operate="ToMall");case 1:case"end":return t.stop()}},t,e)}))()},successExchange:function(){this.exChangeLayer=!1,this.exchageImgUrl="./static/img/exchangeCard.gif",this.exChangeSuccessLayer=!0},errorExchange:function(){this.exChangeLayer=!1,this.exchageImgUrl="./static/img/errorInfo.png",this.exChangeErrLayer=!0},cancelLayer:function(){var e=this;return n()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.v();case 2:return t.sent,t.next=5,c.r();case 5:t.sent,e.$store.dispatch("SetSwipeState",0),e.$store.dispatch("SetSwallowState",0),e.$store.dispatch("SetSwallowComplete",!1),e.$store.dispatch("SetSwipeComplete",!1),e.isMask=!1,e.exChangeLayer=!1,e.waitLayer=!1,e.exChangeSuccessLayer=!1,e.exChangeErrLayer=!1;case 15:case"end":return t.stop()}},t,e)}))()}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"indexPage appabs"},[a("div",{staticClass:"appTit"},[e._v("综合素质")]),e._v(" "),a("div",{staticClass:"appBox"},[a("div",{staticClass:"appUnit app_1",on:{click:e.exchange}},[a("div",{staticClass:"appIcon"}),e._v(" "),a("div",{staticClass:"btnIcon"})]),e._v(" "),a("div",{staticClass:"appUnit app_2",on:{click:e.mallshop}},[a("div",{staticClass:"appIcon"}),e._v(" "),a("div",{staticClass:"btnIcon"})])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isMask,expression:"isMask"}],staticClass:"mask",on:{click:e.cancelLayer}}),e._v(" "),a("transition",{attrs:{name:"sliderRight"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.waitLayer,expression:"waitLayer"}],staticClass:"waitDialog"},[a("div",{staticClass:"waitTit"},[e._v("请刷学生卡")]),e._v(" "),a("div",{staticClass:"waitGif"},[a("img",{attrs:{src:e.stateImgUrl}})])])]),e._v(" "),a("transition",{attrs:{name:"sliderRight"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.exChangeLayer,expression:"exChangeLayer"}],staticClass:"waitDialog",on:{click:e.errorExchange}},[a("div",{staticClass:"exchangeTit"},[e._v("请插入卡片兑换")]),e._v(" "),a("div",{staticClass:"waitGif"},[a("img",{attrs:{src:e.exchageImgUrl}})])])]),e._v(" "),a("transition",{attrs:{name:"sliderRight"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.exChangeErrLayer,expression:"exChangeErrLayer"}],staticClass:"waitDialog",on:{click:e.againExchange}},[a("div",{staticClass:"exchangeTit"},[e._v("请刷有效学生卡")]),e._v(" "),a("div",{staticClass:"errorInfo"},[a("span",[e._v("无效卡")])]),e._v(" "),a("div",{staticClass:"waitGif error"},[a("img",{attrs:{src:e.exchageImgUrl}})])])]),e._v(" "),a("transition",{attrs:{name:"sliderRight"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.exChangeSuccessLayer,expression:"exChangeSuccessLayer"}],staticClass:"waitDialog"},[a("div",{staticClass:"exchangeTit"},[e._v("兑换成功")]),e._v(" "),a("div",{staticClass:"successInfo"},[e._v(e._s(1==e.exChangeResult.rewardType?"分数":"勋章")+"  "),a("span",[e._v("+"+e._s(e.exChangeResult.rewardNum))])]),e._v(" "),a("div",{staticClass:"waitGif successGif"},[a("img",{attrs:{src:e.exchageImgUrl}})]),e._v(" "),a("div",{staticClass:"exchangeBtn"},[a("div",{staticClass:"againExchange",on:{click:e.againExchange}},[e._v("继续兑卡")])])])])],1)},staticRenderFns:[]};var g=a("VU/8")(l,h,!1,function(e){a("G1T1")},"data-v-66a0dcfc",null);t.default=g.exports},G1T1:function(e,t){}});
//# sourceMappingURL=3.55bfa8aa7107124112ee.js.map